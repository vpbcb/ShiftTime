<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Расчет смены</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1976d2">
<link rel="apple-touch-icon" href="main1.png">

<style>
/* =========================
   БАЗОВЫЕ ПЕРЕМЕННЫЕ
========================= */
:root{
  --bg:#f6f7f9;
  --card:#fff;
  --border:#e6e8ee;
  --ctlBorder:#cfd5e1;
  --ink:#111;
  --muted:#5b6474;
  --pillBg:#f0f2f7;
  --accent:#1976d2;

  --titleFs:13.6px;
  --ctlFs:16px;
  --timeFs:18.5px;
  --resultTimeFs:21px;

  --hintFs:12.5px;
  --actionBtnHSmall:38px;

  --fixedHeaderH: 60px;
  --fixedFooterH: 50px;

  /* эталон ширины кнопок */
  --crewBtnWidth: 160px;
}

*{ box-sizing:border-box; font-family:Arial, sans-serif; }
body{ margin:0; background:var(--bg); color:var(--ink); }

/* =========================
   FIXED HEADER / FOOTER
========================= */
.headerFixed{
  position:fixed; top:0; left:0; right:0;
  z-index:1000;
}
.footerFixed{
  position:fixed; bottom:0; left:0; right:0;
  z-index:1000;
}

.headerWrap{ max-width:720px; margin:auto; padding:4px 14px; }
.footerWrap{ max-width:720px; margin:auto; padding:6px 14px; }

.scrollArea{
  position:fixed;
  top:var(--fixedHeaderH);
  bottom:var(--fixedFooterH);
  left:0; right:0;
  overflow:auto;
}

.wrap{ max-width:720px; margin:auto; padding:10px; }

.card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  margin-bottom:8px;
}

/* =========================
   HEADER
========================= */
.headerCard{
  background:var(--accent);
  border-color:var(--accent);
  color:#fff;
  padding:8px 12px;
}
.headerBar{
  display:flex;
  align-items:center;
  gap:10px;
}
h1{
  margin:0;
  font-size:20px;
  flex:1;
  text-align:center;
}

.saveBtn{
  border:1px solid rgba(255,255,255,0.65);
  background:rgba(255,255,255,0.16);
  color:#fff;
  border-radius:10px;
  padding:8px 12px;
  font-weight:700;
  cursor:pointer;
  height:38px;
}
.saveBtn.saved{ background:rgba(255,255,255,0.28); }

/* =========================
   INPUTS / BUTTONS
========================= */
input,button,select{
  padding:10px;
  border-radius:10px;
  border:1px solid var(--ctlBorder);
  background:#fff;
  cursor:pointer;
  font-size:var(--ctlFs);
}

input[type="time"]{
  width:120px;
  font-size:var(--timeFs);
  text-align:center;
}

select.deltaSelect{
  width:120px;
  height:38px;
  font-size:var(--timeFs);
  text-align:center;
}

.fieldTitle{
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--pillBg);
  border:1px solid var(--border);
  border-radius:999px;
  font-size:var(--titleFs);
  padding:6px 10px;
  font-weight:600;
  white-space:nowrap;
}

button.fieldTitle{ cursor:pointer; }

.hasHint{ position:relative; }
.hasHint::after{
  content:"?";
  position:absolute;
  top:-6px; right:-6px;
  width:16px; height:16px;
  border-radius:50%;
  border:1px solid var(--ctlBorder);
  background:#fff;
  font-size:11px;
  line-height:16px;
  text-align:center;
}

/* =========================
   RESULTS
========================= */
.results3{ display:grid; gap:9px; }

.resultCard{
  border:1px solid var(--border);
  border-radius:12px;
  padding:9px;
  background:#fff;
  display:grid;
  grid-template-rows:42px auto;
  text-align:center;
}

.pill{
  display:flex;
  align-items:center;
  justify-content:center;
  height:32px;
  font-size:var(--titleFs);
  border-radius:999px;
  background:var(--pillBg);
  border:1px solid var(--border);
  font-weight:600;
  width:fit-content;
  justify-self:center;
}

.timesTop{ padding-top:6px; }
.out{ font-size:var(--resultTimeFs); font-weight:700; }

.multiTimes{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:8px;
}
.mtCol{ display:flex; flex-direction:column; align-items:center; }
.mtTime{ font-size:var(--resultTimeFs); font-weight:700; }
.mtLbl{ font-size:14px; color:var(--muted); }

/* =========================
   ВЕРТИКАЛЬНАЯ — БАЗА
========================= */
.sixInline{
  display:grid;
  grid-template-columns:1fr auto;
  gap:10px;
  align-items:stretch;
}
.fieldTitle.wrap2{
  white-space:normal;
  line-height:1.15;
  height:42px;
  width:100%;
}

/* =========================
   ГОРИЗОНТАЛЬНАЯ ОРИЕНТАЦИЯ
========================= */
@media (min-width:900px){

  /* ⬇ ВАЖНОЕ ИЗМЕНЕНИЕ */
  .sixInline{
    grid-template-columns: var(--crewBtnWidth) 1fr;
    align-items:center;
  }

  .sixInline .fieldTitle{
    white-space:nowrap;
    display:flex;
    justify-content:center;
    align-items:center;
  }
}

/* =========================
   UPDATE OVERLAY
========================= */
#updateOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:5000;
}
#updateBox{
  background:#1976d2;
  color:#fff;
  padding:18px 22px;
  border-radius:16px;
  font-weight:700;
  box-shadow:0 12px 40px rgba(0,0,0,.3);
}
</style>
</head>

<body>

<!-- UPDATE OVERLAY -->
<div id="updateOverlay">
  <div id="updateBox">Обновление данных. Ждите.</div>
</div>

<!-- HEADER -->
<div class="headerFixed">
  <div class="headerWrap">
    <div class="card headerCard">
      <div class="headerBar">
        <h1>Расчет смены</h1>
        <button id="btnSave" class="saveBtn">Сохранить</button>
      </div>
    </div>
  </div>
</div>

<!-- CONTENT -->
<div class="scrollArea">
  <div class="wrap">

    <!-- РЕЗУЛЬТАТЫ И ВВОДЫ (БЕЗ ИЗМЕНЕНИЙ ЛОГИКИ) -->
    <!-- ... ваш существующий HTML БЕЗ ИЗМЕНЕНИЙ ... -->

  </div>
</div>

<!-- FOOTER -->
<div class="footerFixed">
  <div class="footerWrap">
    <button class="saveBtn" style="width:100%; background:#1976d2;">Сбросить</button>
  </div>
</div>

<script>
/* ===== UPDATE OVERLAY LOGIC ===== */
(function(){
  const overlay = document.getElementById("updateOverlay");
  let timer=null;

  function showUpdate(){
    overlay.style.display="flex";
    clearTimeout(timer);
    timer=setTimeout(()=>{ overlay.style.display="none"; },2000);
  }

  if("serviceWorker" in navigator){
    navigator.serviceWorker.addEventListener("message", e=>{
      if(e.data?.type==="UPDATING") showUpdate();
    });
  }
})();
</script>

<script>
if("serviceWorker" in navigator){
  window.addEventListener("load",()=>{
    navigator.serviceWorker.register("./sw.js");
  });
}
</script>

</body>
</html>
